ExoMol
--------------

Molecular Database
======================

`ExoMol <http://www.exomol.com/>`_ provides molecular line database of various molecules and also from various sources. For instance, they provide `multiple source of the line data of the carbon monoxide (CO) <http://www.exomol.com/data/molecules/CO/12C-16O/>`_. So, we need to specify which database you use.

exojax specifies the default database for each molecule. You can know by

.. code:: ipython
	  
	  >>> from exojax.spec import defmol
	  >>> defmol.search_molfile("ExoMol","12C-16O")
	  'CO/12C-16O/Li2015'


An example to use the ExoMol database from exojax is like that.

.. code:: python

	  >>> from exojax.spec import moldb
	  >>> from exojax.spec.rtransfer import nugrid
	  >>> nus,wav,res=nugrid(22880.,23000.,1000,unit="AA")
	  >>> mdbCO=moldb.MdbExomol('.database/CO/12C-16O/Li2015',nus)
	  Background atmosphere:  H2
	  Reading transition file
	  Broadening code level= a0
	  default broadening parameters are used for  71  J lower states in  152  states

Broadening Parameters
======================

exojax uses .broad file as the broadening parameters. The comment

.. code:: python

	  Broadening code level= a0

means the broadening parameters as a function of the lower J-quantum number is used.  
 
.. code:: python

	  default broadening parameters are used for  71  J lower states in  152  states

However, the broadning parameters are not often provided for higher J values. Instead, exojax uses the default values in .def file for them.  

Feather File Format
=====================

For the first time to load the Exomol database using :doc:`../exojax/exojax.spec` , exojax automatically converts the transition and state files into `Feather File Format <https://arrow.apache.org/docs/python/feather.html>`_.

.. code:: sh

	  penchan:~/exojax/data/CO/12C-16O/Li2015>ls -1
	  
	  12C-16O__H2.broad
	  12C-16O__He.broad
	  12C-16O__Li2015.def
	  12C-16O__Li2015.pf
	  12C-16O__Li2015.states.bz2
	  12C-16O__Li2015.states.feather
	  12C-16O__Li2015.trans.bz2
	  12C-16O__Li2015.trans.feather

The files with a suffix of ".feather" were generated by exojax. After the second time, exojax will use these feather files, which significantly decrease the loading time. exojax also use .broad file for the broadening parameters.


Basic Quantities
==================


+-----------------------+-------------+----+------+
|**quantity**           |**instance** |unit|np/jnp|
+-----------------------+-------------+----+------+
|line center            |nu_lines     |cm-1|np    |
+-----------------------+-------------+----+------+
|line center            |dev_nu_lines |cm-1|jnp   |
+-----------------------+-------------+----+------+
|lower state energy     |elower       |cm-1|jnp   |
+-----------------------+-------------+----+------+
|natural broadening     |gamma_natural|cm-1|jnp   |
+-----------------------+-------------+----+------+
|Einstein coefficient   |A            |s-1 |jnp   |
+-----------------------+-------------+----+------+
|reference line strength|Sij0         |cm  |np    |
+-----------------------+-------------+----+------+
|log10 Sij0             |logsij0      |    |jnp   |
+-----------------------+-------------+----+------+
|statistical weight     |gpp          |    |jnp   |
+-----------------------+-------------+----+------+
|J_lower                |jlower       |    |jnp   |
+-----------------------+-------------+----+------+
|J_upper                |jupper       |    |jnp   |
+-----------------------+-------------+----+------+
|temperature exponent   |n_Tref       |    |jnp   |
+-----------------------+-------------+----+------+
|alpha_ref (gamma0)     |alpha_ref    |    |jnp   |
+-----------------------+-------------+----+------+
